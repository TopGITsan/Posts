<form
  [formGroup]="postForm"
  [patchFormGroupValues]="formValues$ | async"
  (ngSubmit)="onSubmit()"
  class="mb-4 rounded bg-white px-8 pb-8 pt-6 shadow-md">
  <h2 class="mb-4 text-2xl font-bold">Post Details</h2>
  <div>
    <label
      for="title"
      class="mb-2 block text-sm font-bold text-gray-700"
      >Title:</label
    >
    <input
      type="text"
      id="title"
      [appFocus]="true"
      formControlName="title"
      #title="control"
      placeholder="Enter Post Title"
      class="focus:shadow-outline w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none" />
    @if (
      title.control?.invalid && (title.control?.dirty || title.control?.touched)
    ) {
      <span>Has Error: </span>
      @if (title.control?.hasError('required')) {
        <span>Is required</span>
      }
    }
  </div>
  <div>
    <label
      for="body"
      class="mb-2 block text-sm font-bold text-gray-700"
      >Body:</label
    >
    <textarea
      id="body"
      formControlName="body"
      #body="control"
      placeholder="Enter Post Body"
      class="focus:shadow-outline h-32 w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none"></textarea>
    @if (
      body.control?.invalid && (body.control?.dirty || body.control?.touched)
    ) {
      <span>Has Error: </span>
      @if (body.control?.hasError('required')) {
        <span>Is required</span>
      }
    }
  </div>
  Â 

  <h3 class="mb-2 mt-4 text-xl font-bold">User Information</h3>
  <div formGroupName="user">
    <div class="mt-4">
      <label
        for="name"
        class="mb-2 block text-sm font-bold text-gray-700"
        >User Name:</label
      >
      <input
        type="text"
        id="name"
        #name="control"
        formControlName="name"
        placeholder="Enter User Name"
        class="focus:shadow-outline w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none" />
      @if (
        name.control?.invalid && (name.control?.dirty || name.control?.touched)
      ) {
        <span>Has Error: </span>
        @if (name.control?.hasError('required')) {
          <span>Is required</span>
        }
      }
    </div>
    <div class="mt-4">
      <label
        for="email"
        class="mb-2 block text-sm font-bold text-gray-700"
        >User Email:</label
      >
      <input
        type="email"
        id="email"
        formControlName="email"
        #email="control"
        placeholder="Enter User Email"
        class="focus:shadow-outline w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none" />

      @if (
        email.control?.invalid &&
        (email.control?.dirty || email.control?.touched)
      ) {
        <span>Has Error: </span>
        @if (email.control?.hasError('required')) {
          <span> Is required </span>
        }
        @if (email.control?.hasError('email')) {
          <span> Is not an email </span>
        }
      }
    </div>

    <div class="mt-4">
      <label
        for="username"
        class="mb-2 block text-sm font-bold text-gray-700"
        >Username:</label
      >
      <input
        type="username"
        id="username"
        formControlName="username"
        #username="control"
        placeholder="Enter Username"
        class="focus:shadow-outline w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none" />
      @if (
        username.control?.invalid &&
        (username.control?.dirty || username.control?.touched)
      ) {
        <span>Has Error: </span>
        @if (username.control?.hasError('required')) {
          <span>Is required</span>
        }
      }
    </div>
    <div class="mt-4">
      <label
        for="phone"
        class="mb-2 block text-sm font-bold text-gray-700"
        >User phone:</label
      >
      <input
        type="tel"
        id="phone"
        formControlName="phone"
        #phone="control"
        placeholder="Enter User Phone"
        class="focus:shadow-outline w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none" />
      @if (
        phone.control?.invalid &&
        (phone.control?.dirty || phone.control?.touched)
      ) {
        <span>Has Error: </span>
        @if (phone.control?.hasError('required')) {
          <span>Is required</span>
        }
      }
    </div>
    <div class="mt-4">
      <label
        for="website"
        class="mb-2 block text-sm font-bold text-gray-700"
        >User website:</label
      >
      <input
        type="url"
        id="website"
        formControlName="website"
        #website="control"
        placeholder="Enter User Website"
        class="focus:shadow-outline w-full appearance-none rounded border px-3 py-2 leading-tight text-gray-700 shadow focus:outline-none" />
      @if (
        website.control?.invalid &&
        (website.control?.dirty || website.control?.touched)
      ) {
        <span>Has Error: </span>
        @if (website.control?.hasError('required')) {
          <span>Is required</span>
        }
      }
    </div>

    <mat-form-field class="my-4 w-full">
      <mat-label class="text-sm font-bold">Permission:</mat-label>
      <mat-select
        formControlName="permission"
        required>
        @for (permission of permissions; track permission) {
          <mat-option
            [value]="permission"
            selected
            >{{ permission }}</mat-option
          >
        }
      </mat-select>
    </mat-form-field>
  </div>

  <button
    type="submit"
    [disabled]="postForm.invalid"
    class="focus:shadow-outline rounded bg-blue-500 px-4 py-2 font-bold text-white focus:outline-none disabled:bg-gray-400 disabled:hover:bg-gray-400">
    Submit Post
  </button>
</form>
